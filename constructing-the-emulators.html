<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Constructing the emulators | Tutorial 2: An introduction to the main functionalities of the hmer package</title>
  <meta name="description" content="An easy guide to the main functionalities of the hmer package" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Constructing the emulators | Tutorial 2: An introduction to the main functionalities of the hmer package" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An easy guide to the main functionalities of the hmer package" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Constructing the emulators | Tutorial 2: An introduction to the main functionalities of the hmer package" />
  
  <meta name="twitter:description" content="An easy guide to the main functionalities of the hmer package" />
  

<meta name="author" content="Danny Scarponi, Andy Iskauskas" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-structure-of-an-emulator.html"/>
<link rel="next" href="implau.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script language="javascript"> 
    function toggle(id) {
        var ele = document.getElementById("toggleText" + id);
        var text = document.getElementById("displayText" + id);
        var buttonText = text.innerHTML.replace("Show ", "");
        buttonText = buttonText.replace("Hide ", "");
        if(ele.style.display == "block") {
            ele.style.display = "none";
            text.innerHTML = "Show " + buttonText;
        } else {
            ele.style.display = "block";
            text.innerHTML = "Hide " + buttonText;
        }
    } 
</script>

<script language="javascript">
    function openCode(evt, codeName, id) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent" + id);
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks" + id);
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(codeName).style.display = "block";
        evt.currentTarget.className += " active";
    }
</script>

<script language="javascript">
    function hide(id){
        document.getElementById(id).style.display = "none";
    }
</script>
</script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the model</a></li>
<li class="chapter" data-level="2" data-path="perfoming-a-full-wave-of-emulation-and-history-matching.html"><a href="perfoming-a-full-wave-of-emulation-and-history-matching.html"><i class="fa fa-check"></i><b>2</b> Perfoming a full wave of emulation and history matching</a></li>
<li class="chapter" data-level="3" data-path="the-structure-of-an-emulator.html"><a href="the-structure-of-an-emulator.html"><i class="fa fa-check"></i><b>3</b> The structure of an emulator</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-structure-of-an-emulator.html"><a href="the-structure-of-an-emulator.html#the-global-behaviour-of-the-output"><i class="fa fa-check"></i><b>3.1</b> The global behaviour of the output</a></li>
<li class="chapter" data-level="3.2" data-path="the-structure-of-an-emulator.html"><a href="the-structure-of-an-emulator.html#the-local-deviations-from-the-global-behaviour"><i class="fa fa-check"></i><b>3.2</b> The local deviations from the global behaviour</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="constructing-the-emulators.html"><a href="constructing-the-emulators.html"><i class="fa fa-check"></i><b>4</b> Constructing the emulators</a></li>
<li class="chapter" data-level="5" data-path="implau.html"><a href="implau.html"><i class="fa fa-check"></i><b>5</b> History matching using implausibility</a>
<ul>
<li class="chapter" data-level="5.1" data-path="implau.html"><a href="implau.html#the-implausibility-measure"><i class="fa fa-check"></i><b>5.1</b> The implausibility measure</a></li>
<li class="chapter" data-level="5.2" data-path="implau.html"><a href="implau.html#combining-outputs-together"><i class="fa fa-check"></i><b>5.2</b> Combining outputs together</a></li>
<li class="chapter" data-level="5.3" data-path="implau.html"><a href="implau.html#implausibility-visualisations"><i class="fa fa-check"></i><b>5.3</b> Implausibility visualisations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>6</b> Emulator diagnostics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="diagnostics.html"><a href="diagnostics.html#the-three-main-diagnostics"><i class="fa fa-check"></i><b>6.1</b> The three main diagnostics</a></li>
<li class="chapter" data-level="6.2" data-path="diagnostics.html"><a href="diagnostics.html#parameter-sets-failing-diagnostics"><i class="fa fa-check"></i><b>6.2</b> Parameter sets failing diagnostics</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="diagnostics.html"><a href="diagnostics.html#visualisation"><i class="fa fa-check"></i><b>6.2.1</b> Visualisation</a></li>
<li class="chapter" data-level="6.2.2" data-path="diagnostics.html"><a href="diagnostics.html#space-removed-function"><i class="fa fa-check"></i><b>6.2.2</b> Space removed function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="newpoints.html"><a href="newpoints.html"><i class="fa fa-check"></i><b>7</b> Constructing the next wave of the history match: point generation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="newpoints.html"><a href="newpoints.html#generating-sets-of-parameters-for-the-next-wave"><i class="fa fa-check"></i><b>7.1</b> Generating sets of parameters for the next wave</a></li>
<li class="chapter" data-level="7.2" data-path="newpoints.html"><a href="newpoints.html#comparing-new-and-old-parameter-sets"><i class="fa fa-check"></i><b>7.2</b> Comparing new and old parameter sets</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="further-waves.html"><a href="further-waves.html"><i class="fa fa-check"></i><b>8</b> Further waves</a>
<ul>
<li class="chapter" data-level="8.1" data-path="further-waves.html"><a href="further-waves.html#wave1"><i class="fa fa-check"></i><b>8.1</b> Next wave: wave 1</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="further-waves.html"><a href="further-waves.html#training-wave-1-emulators"><i class="fa fa-check"></i><b>8.1.1</b> Training wave 1 emulators</a></li>
<li class="chapter" data-level="8.1.2" data-path="further-waves.html"><a href="further-waves.html#evaluating-implausibility-across-all-waves"><i class="fa fa-check"></i><b>8.1.2</b> Evaluating implausibility across all waves</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="further-waves.html"><a href="further-waves.html#next-wave-wave-2"><i class="fa fa-check"></i><b>8.2</b> Next wave: wave 2</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="further-waves.html"><a href="further-waves.html#training-wave-2-emulators"><i class="fa fa-check"></i><b>8.2.1</b> Training wave 2 emulators</a></li>
<li class="chapter" data-level="8.2.2" data-path="further-waves.html"><a href="further-waves.html#evaluating-implausibility-across-all-waves-1"><i class="fa fa-check"></i><b>8.2.2</b> Evaluating implausibility across all waves</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="further-waves.html"><a href="further-waves.html#next-wave-wave-3"><i class="fa fa-check"></i><b>8.3</b> Next wave: wave 3</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="further-waves.html"><a href="further-waves.html#training-wave-3-emulators"><i class="fa fa-check"></i><b>8.3.1</b> Training wave 3 emulators</a></li>
<li class="chapter" data-level="8.3.2" data-path="further-waves.html"><a href="further-waves.html#stoprule"><i class="fa fa-check"></i><b>8.3.2</b> Evaluating implausibility across all waves</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="glossary.html"><a href="glossary.html"><i class="fa fa-check"></i><b>9</b> Glossary</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="bayes.html"><a href="bayes.html"><i class="fa fa-check"></i><b>A</b> Bayes Linear Emulation</a></li>
<li class="chapter" data-level="B" data-path="emulstr.html"><a href="emulstr.html"><i class="fa fa-check"></i><b>B</b> Further issues in emulator structure</a>
<ul>
<li class="chapter" data-level="B.1" data-path="emulstr.html"><a href="emulstr.html#regression-structure"><i class="fa fa-check"></i><b>B.1</b> Regression structure</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="emulstr.html"><a href="emulstr.html#active-variables-identification-and-benefits"><i class="fa fa-check"></i><b>B.1.1</b> Active variables identification and benefits</a></li>
<li class="chapter" data-level="B.1.2" data-path="emulstr.html"><a href="emulstr.html#building-the-model"><i class="fa fa-check"></i><b>B.1.2</b> Building the model</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="emulstr.html"><a href="emulstr.html#correlation-structure"><i class="fa fa-check"></i><b>B.2</b> Correlation structure</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tutorial 2: An introduction to the main functionalities of the hmer package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="constructing-the-emulators" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Constructing the emulators<a href="constructing-the-emulators.html#constructing-the-emulators" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>To construct the emulators, we use the function <code>emulator_from_data</code>, which requires at least the training data, the name of the model outputs to emulate and the list of parameter ranges. In this case study we also use the optional argument <code>ev</code> to pass our estimates of the ensemble variability. We first define the model output names and we calculate the ensemble variability <code>evs</code> taking the mean of the column <span class="math inline">\(EV\)</span> in <code>wave0</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="constructing-the-emulators.html#cb17-1" tabindex="-1"></a>output_names <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;I&quot;</span>, <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">30</span>, <span class="at">by=</span><span class="dv">5</span>))</span>
<span id="cb17-2"><a href="constructing-the-emulators.html#cb17-2" tabindex="-1"></a>evs <span class="ot">&lt;-</span> <span class="fu">apply</span>(wave0[<span class="dv">10</span><span class="sc">:</span><span class="fu">ncol</span>(wave0)], <span class="dv">2</span>, mean)</span></code></pre></div>
<p>The function <code>emulator_from_data</code> uses <code>evs</code> to estimate the delta parameter, i.e. the proportion of the overall variance due to the ensemble variability.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="constructing-the-emulators.html#cb18-1" tabindex="-1"></a>ems0 <span class="ot">&lt;-</span> <span class="fu">emulator_from_data</span>(train0, output_names, ranges, <span class="at">ev=</span>evs)</span>
<span id="cb18-2"><a href="constructing-the-emulators.html#cb18-2" tabindex="-1"></a>ems0[[<span class="dv">1</span>]]</span>
<span id="cb18-3"><a href="constructing-the-emulators.html#cb18-3" tabindex="-1"></a><span class="co">#&gt; Parameters and ranges:  beta: c(0.2, 0.8): gamma: c(0.2, 1): delta: c(0.1, 0.5): mu: c(0.1, 0.5) </span></span>
<span id="cb18-4"><a href="constructing-the-emulators.html#cb18-4" tabindex="-1"></a><span class="co">#&gt; Specifications: </span></span>
<span id="cb18-5"><a href="constructing-the-emulators.html#cb18-5" tabindex="-1"></a><span class="co">#&gt;   Basis functions:  (Intercept); beta; gamma; delta; mu; I(delta^2); beta:gamma; beta:delta; gamma:delta </span></span>
<span id="cb18-6"><a href="constructing-the-emulators.html#cb18-6" tabindex="-1"></a><span class="co">#&gt;   Active variables beta; gamma; delta; mu </span></span>
<span id="cb18-7"><a href="constructing-the-emulators.html#cb18-7" tabindex="-1"></a><span class="co">#&gt;   Regression Surface Expectation:  79.4188; 93.1408; 42.2031; -102.4974; 4.5401; 54.2205; 50.5944; -72.7635; -32.854 </span></span>
<span id="cb18-8"><a href="constructing-the-emulators.html#cb18-8" tabindex="-1"></a><span class="co">#&gt;   Regression surface Variance (eigenvalues):  0; 0; 0; 0; 0; 0; 0; 0; 0 </span></span>
<span id="cb18-9"><a href="constructing-the-emulators.html#cb18-9" tabindex="-1"></a><span class="co">#&gt; Correlation Structure: </span></span>
<span id="cb18-10"><a href="constructing-the-emulators.html#cb18-10" tabindex="-1"></a><span class="co">#&gt; Bayes-adjusted emulator - prior specifications listed. </span></span>
<span id="cb18-11"><a href="constructing-the-emulators.html#cb18-11" tabindex="-1"></a><span class="co">#&gt;   Variance (Representative):  251.1956 </span></span>
<span id="cb18-12"><a href="constructing-the-emulators.html#cb18-12" tabindex="-1"></a><span class="co">#&gt;   Expectation:  0 </span></span>
<span id="cb18-13"><a href="constructing-the-emulators.html#cb18-13" tabindex="-1"></a><span class="co">#&gt;   Correlation type: exp_sq </span></span>
<span id="cb18-14"><a href="constructing-the-emulators.html#cb18-14" tabindex="-1"></a><span class="co">#&gt;   Hyperparameters:  theta: 0.8621 </span></span>
<span id="cb18-15"><a href="constructing-the-emulators.html#cb18-15" tabindex="-1"></a><span class="co">#&gt;   Nugget term: 0 </span></span>
<span id="cb18-16"><a href="constructing-the-emulators.html#cb18-16" tabindex="-1"></a><span class="co">#&gt; Mixed covariance:  0 0 0 0 0 0 0 0 0</span></span></code></pre></div>
<p><infobutton id="displayTextunnamed-chunk-28" onclick="javascript:toggle('unnamed-chunk-28');">Show: More details about the emulator_from_data and its output</infobutton></p>
<div id="toggleTextunnamed-chunk-28" style="display: none">
<div class="panel panel-default">
<div class="panel-body">
<p>The <code>emulator_from_data</code> buils emulators in two distinct steps. It first creates a set of ‘initial’ emulators by fitting a regression surface to <code>train0</code>. Both the regression parameters and the active parameters for each of the indicated model outputs are found: model selection is performed through <a href="https://en.wikipedia.org/wiki/Stepwise_regression">stepwise addition or deletion</a> (as appropriate), using the <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion">AIC criterion</a> to find the minimal best fit. The default behaviour of <code>emulator_from_data</code> is to fit a quadratic regression surface: if we want instead a linear regression surface, we just need to set <code>quadratic=FALSE</code>. We note that in principle we can insert basis functions of any form for the regression surface.</p>
<p>The ‘initial’ emulators, which provide not only estimates for the regression surface parameters, but also estimates for the correlation specifications, are then adjusted to the training data through the Bayes Linear update formulae.</p>
<p>The print statement ‘ems0[[1]]’ provides an overview of the emulator specifications and correlation structure, including</p>
<ul>
<li><p>Basis Functions: here we have the four parameters beta, gamma, delta, mu and some products of them, since we chose quadratic regression. Note that beta:mu and all pure quadratic terms (such as beta:beta) are not listed: this means that stepwise addition and deletion led to discarding them,</p></li>
<li><p>Active variables,</p></li>
<li><p>first and second order specifications for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(u(x)\)</span>. Note that by default <code>emulator_from_data</code> assumes that <span class="math inline">\(\text{Var}[\beta]=0\)</span>: the regression surface is known and coefficients are fixed. This explains why Beta Variance and Mixed Covariance (which shows the covariance of <span class="math inline">\(\beta\)</span> and <span class="math inline">\(u(x)\)</span>) are both zero. One can set beta.var=TRUE in order to consider the beta parameters as random variables.</p>
</div>
</div>
</div></li>
</ul>
<p>We can plot the emulators to see how they represent the output space: the <code>emulator_plot</code> function does this for emulator expectation, variance, standard deviation, and implausibility (more on which later). Note that all functions in the <em>hmer</em> package that produce plots have a colorblind-friendly option: it is sufficient to specify <code>cb=TRUE</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="constructing-the-emulators.html#cb19-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ems0)) ems0[[i]]<span class="sc">$</span>output_name <span class="ot">&lt;-</span> output_names[i]</span>
<span id="cb19-2"><a href="constructing-the-emulators.html#cb19-2" tabindex="-1"></a><span class="fu">names</span>(ems0) <span class="ot">&lt;-</span> output_names</span>
<span id="cb19-3"><a href="constructing-the-emulators.html#cb19-3" tabindex="-1"></a><span class="fu">emulator_plot</span>(ems0, <span class="at">cb=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" style="display: block; margin: auto;" /></p>
<p>The emulator expectation plots show the structure of the regression surface, which is at most quadratic in its parameters, through a 2D slice of the input space. Here parameters <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> are selected and we get a plot for each model output. For each pair <span class="math inline">\((\bar \beta,\bar \gamma)\)</span> the plot shows the expected value produced by the relative emulator at the point <span class="math inline">\((\bar \beta,\bar \gamma, \delta_{\text{mid-range}}, \mu_{\text{mid-range}})\)</span>, where <span class="math inline">\(\delta_{\text{mid-range}}\)</span> indicates the mid-range value of <span class="math inline">\(\delta\)</span> and similarly for <span class="math inline">\(\mu_{\text{mid-range}}\)</span>.</p>
<p>To plot the emulators standard deviation we just use <code>emulator_plot</code> passing ‘sd’ as second argument:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="constructing-the-emulators.html#cb20-1" tabindex="-1"></a><span class="fu">emulator_plot</span>(ems0, <span class="st">&#39;sd&#39;</span>, <span class="at">cb=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" style="display: block; margin: auto;" /></p>
<p>We can see that the emulators reasonably show the structure of the model: the closer the evaluation point is to a training point, the lower the variance (as it ‘knows’ the value at this point). In fact, evaluating these emulators at parameter sets in the training data demonstrates this fact:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="constructing-the-emulators.html#cb21-1" tabindex="-1"></a>em_evals <span class="ot">&lt;-</span> ems0<span class="sc">$</span>I10<span class="sc">$</span><span class="fu">get_exp</span>(train0[,<span class="fu">names</span>(ranges)])</span>
<span id="cb21-2"><a href="constructing-the-emulators.html#cb21-2" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">abs</span>(em_evals <span class="sc">-</span> train0<span class="sc">$</span>I10) <span class="sc">&lt;</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">12</span>))</span>
<span id="cb21-3"><a href="constructing-the-emulators.html#cb21-3" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>In the next section we will define the implausibility measure while in section <a href="diagnostics.html#diagnostics">6</a> we will explain how to assess whether the emulators we trained are performing as we would expect them to.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-structure-of-an-emulator.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="implau.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
